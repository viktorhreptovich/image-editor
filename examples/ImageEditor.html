<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8"/>
    <title>Kendo UI Snippet</title>

    <link rel="stylesheet" href="https://kendo.cdn.telerik.com/2018.2.620/styles/kendo.common.min.css"/>
    <link rel="stylesheet" href="https://kendo.cdn.telerik.com/2018.2.620/styles/kendo.rtl.min.css"/>
    <link rel="stylesheet" href="https://kendo.cdn.telerik.com/2018.2.620/styles/kendo.silver.min.css"/>
    <link rel="stylesheet" href="https://kendo.cdn.telerik.com/2018.2.620/styles/kendo.mobile.all.min.css"/>

    <script src="https://code.jquery.com/jquery-1.12.4.min.js"></script>
    <script src="https://kendo.cdn.telerik.com/2018.2.620/js/kendo.all.min.js"></script>
    <script src="shapes/rectangle.js"></script>
    <script src="shapes/circle.js"></script>

</head>
<body>
    <div id="toolbar"></div>
    <input type="color" id="myColorField" />
    <select id="size">
        <option value="1">1px</option>
        <option value="2">2px</option>
        <option value="3">3px</option>
        <option value="5">5px</option>
        <option value="7">7px</option>
    </select>


    <div id="surface" style="width: 500px; height: 500px;border: 1px solid black;cursor: crosshair;position:absolute;z-index:1"></div>
    <script>
      var colorShape = 'black';
      var widthLine = 1;

      var ListDraw = [];

      var element = $("#surface");
      var drawing = kendo.drawing;
      var shape = new Rectangle();


      $(document).ready(function () {
          $("#toolbar").kendoToolBar({
              items: [
                  {
                      type: "buttonGroup",
                      buttons: [
                          { icon: "pencil", text: "Pen", togglable: true, group: "shape", toggle: function () {
                                  alert('Not supported yet');
                              } },
                          { icon: "line", text: "Line", togglable: true, group: "shape",toggle:function () {
                                  alert('Not supporte yet');
                              } },
                          { icon: "checkbox", text: "Rectange", togglable: true, group: "shape",selected:true, toggle:function () {
                                  shape = new Rectangle();
                                  shape.color = colorShape;
                                  shape.thickness = widthLine;
                              } },
                          { icon: "radiobutton", text: "Circle", togglable: true, group: "shape",toggle:function () {
                                  shape = new Circle();
                                  shape.color = colorShape;
                                  shape.thickness = widthLine;
                              } }
                      ]
                  }
                  ]
          });


        $("#myColorField").kendoColorPicker({ palette: "websafe",
		change: function(e){
            colorShape = e.value;
            shape.color = colorShape;
		}
        });

        $("#size").kendoDropDownList({
            change: function (e) {

                var dataItem = this.dataItem(e.item);
                widthLine = dataItem.value;
                shape.thickness =widthLine;
            }
        }
        );

      });


      element.kendoTouch({
        dragstart: function (e) {
          e.event.preventDefault();
          shape.startPoint = surfacePoint(e);
        },
        drag: function (e) {
          shape.endPoint = surfacePoint(e);
          surface = drawing.Surface.create(element);
          shape.draw(surface);
            ListDraw.forEach(function(shapeElement){
                surface.draw(shapeElement)
            });
        },
        dragend: function (e) {
          shape.endPoint = surfacePoint(e);
          ListDraw.push(shape.getShape());
          surface = drawing.Surface.create(element);
          ListDraw.forEach(function(shapeElement){
              surface.draw(shapeElement)
          });
        }
      });

      function surfacePoint(e) {
        e.event.preventDefault();
        var offset = element.offset();
        var x = e.touch.x.location - offset.left;
        var y = e.touch.y.location - offset.top;
        return new kendo.geometry.Point(x,y);
      }

    </script>
</body>
</html>